<div class="admin-dashboard">
  <div class="page-header">
    <div>
      <p class="eyebrow">Painel Administrativo</p>
      <h1>Dashboard</h1>
      <p class="muted">Visão geral da academia</p>
    </div>
    <button mat-stroked-button color="primary" (click)="carregarEstatisticas()" [disabled]="loading">
      <mat-icon>refresh</mat-icon>
      Atualizar
    </button>
  </div>

  <div class="loading" *ngIf="loading">
    <mat-progress-spinner diameter="48" mode="indeterminate"></mat-progress-spinner>
  </div>

  <ng-container *ngIf="!loading">
    <div class="stat-grid">
      <mat-card>
        <mat-card-header>
          <mat-icon mat-card-avatar color="primary">groups</mat-icon>
          <mat-card-title>Total de Alunos</mat-card-title>
          <mat-card-subtitle>{{ stats.alunos_ativos }} ativos</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-value">{{ stats.total_alunos }}</div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-icon mat-card-avatar color="primary">task_alt</mat-icon>
          <mat-card-title>Check-ins Hoje</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-value">{{ stats.total_checkins_hoje }}</div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-icon mat-card-avatar color="primary">event_available</mat-icon>
          <mat-card-title>Check-ins do Mês</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-value">{{ stats.total_checkins_mes }}</div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-icon mat-card-avatar color="primary">warning_amber</mat-icon>
          <mat-card-title>Planos Vencendo</mat-card-title>
          <mat-card-subtitle>Próximos 7 dias</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-value">{{ stats.planos_vencendo }}</div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-icon mat-card-avatar color="primary">payments</mat-icon>
          <mat-card-title>Receita Mensal</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-value">{{ formatarMoeda(stats.receita_mensal) }}</div>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="section">
      <h2>Estatísticas detalhadas</h2>
      <div class="stat-grid small">
        <mat-card>
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">person_add</mat-icon>
            <mat-card-title>Novos no mês</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="stat-value">{{ stats.novos_alunos_mes }}</div>
          </mat-card-content>
        </mat-card>

        <mat-card>
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">person_off</mat-icon>
            <mat-card-title>Alunos inativos</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="stat-value">{{ stats.alunos_inativos }}</div>
          </mat-card-content>
        </mat-card>

        <mat-card>
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">donut_large</mat-icon>
            <mat-card-title>Taxa de atividade</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="stat-value">{{ calcularPercentualAtivos() }}%</div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>

    <div class="section">
      <mat-card>
        <mat-card-header>
          <mat-icon mat-card-avatar color="primary">apartment</mat-icon>
          <mat-card-title>Minha Academia</mat-card-title>
          <mat-card-subtitle>Perfil do Tenant</mat-card-subtitle>
        </mat-card-header>
        <mat-card-actions>
          <button mat-stroked-button color="primary" routerLink="/admin/perfil-tenant">
            <mat-icon>settings</mat-icon>
            Configurar
          </button>
        </mat-card-actions>
      </mat-card>
    </div>

    <div class="section">
      <div class="section-head">
        <div>
          <h2>Cadastros</h2>
          <p class="muted">Gerencie os cadastros principais do sistema</p>
        </div>
      </div>
      <div class="action-grid">
        <mat-card class="action-card" routerLink="/admin/alunos">
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">group</mat-icon>
            <mat-card-title>Alunos</mat-card-title>
            <mat-card-subtitle>Cadastrar e gerenciar alunos</mat-card-subtitle>
          </mat-card-header>
        </mat-card>

        <mat-card class="action-card" routerLink="/admin/gerenciar-horarios">
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">event_note</mat-icon>
            <mat-card-title>Planejamento</mat-card-title>
            <mat-card-subtitle>Horários semanais e mensais</mat-card-subtitle>
          </mat-card-header>
        </mat-card>

        <mat-card class="action-card" routerLink="/admin/dias">
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">today</mat-icon>
            <mat-card-title>Dias</mat-card-title>
            <mat-card-subtitle>Gerenciar dias de aula</mat-card-subtitle>
          </mat-card-header>
        </mat-card>

        <mat-card class="action-card" routerLink="/admin/turmas">
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">schedule</mat-icon>
            <mat-card-title>Turmas</mat-card-title>
            <mat-card-subtitle>Gerenciar horários de turmas</mat-card-subtitle>
          </mat-card-header>
        </mat-card>

        <mat-card class="action-card" routerLink="/admin/checkin-manual">
          <mat-card-header>
            <mat-icon mat-card-avatar color="primary">check_circle</mat-icon>
            <mat-card-title>Check-in Manual</mat-card-title>
            <mat-card-subtitle>Registrar check-in de alunos</mat-card-subtitle>
          </mat-card-header>
        </mat-card>
      </div>
    </div>
  </ng-container>
</div>
