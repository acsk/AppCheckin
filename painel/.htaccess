# Habilitar reescrita de URL
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Se o arquivo/diretório existe, deixar passar
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # Se não estiver em /dist, redirecionar para /dist
  RewriteCond %{REQUEST_URI} !^/dist/ [NC]
  RewriteRule ^(.*)$ /dist/$1 [L]
  
  # Dentro de /dist, SPA routing - se não for arquivo/diretório, ir para index.html
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^dist/(.*)$ /dist/index.html [QSA,L]
</IfModule>

# Configurar tipos MIME
<IfModule mod_mime.c>
  AddType application/javascript js
  AddType application/json json
  AddType text/css css
  AddEncoding gzip .gz
</IfModule>

# Cache
<IfModule mod_headers.c>
  # Cache para arquivos estáticos
  <FilesMatch "\.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2)$">
    Header set Cache-Control "max-age=31536000, public"
  </FilesMatch>
  
  # Sem cache para HTML
  <FilesMatch "\.html$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
  </FilesMatch>
</IfModule>

# Compressão GZIP
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE text/javascript
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/json
</IfModule>
